<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Staff Dashboard - Mustard Seed Caf√©</title>
  <meta name="description" content="Staff dashboard for managing loyalty program data" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --mustard: #D6A319;
      --charcoal: #1F2937;
      --cream: #FFFAF0;
    }
    body {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
    }
    html {
      scroll-behavior: smooth;
    }
    @media (prefers-reduced-motion: reduce) {
      html { scroll-behavior: auto; }
    }
  </style>
</head>
<body class="bg-[var(--cream)] text-[var(--charcoal)]">
  <header class="bg-[var(--charcoal)] text-white py-6">
    <div class="max-w-6xl mx-auto px-4 sm:px-6">
      <h1 class="text-3xl font-bold">Staff Dashboard</h1>
      <p class="text-white/80 mt-2">Loyalty Program Management</p>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 sm:px-6 py-12">
    <!-- Password Protection -->
    <div id="passwordForm" class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-8">
      <h2 class="text-2xl font-semibold mb-6 text-center">Staff Access</h2>
      <form id="staffLoginForm" class="space-y-4">
        <div>
          <label for="staffPassword" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
          <input type="password" id="staffPassword" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--mustard)] focus:border-transparent" placeholder="Enter staff password">
        </div>
        <button type="submit" class="w-full bg-[var(--mustard)] text-[var(--charcoal)] font-medium py-3 px-4 rounded-md hover:bg-[var(--mustard)]/90 transition-colors">
          Access Dashboard
        </button>
      </form>
    </div>

    <!-- Main Dashboard (hidden initially) -->
    <div id="dashboard" class="hidden">
      <div class="bg-white rounded-lg shadow-lg p-8">
        <h2 class="text-2xl font-semibold mb-6">Registered Customers</h2>

        <div class="mb-6">
          <button id="exportBtn" class="bg-[var(--mustard)] text-[var(--charcoal)] px-6 py-3 rounded-lg font-semibold hover:bg-[var(--mustard)]/90 transition-colors">
            Export to CSV
          </button>
          <button id="refreshBtn" class="ml-4 bg-gray-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-600 transition-colors">
            Refresh Data
          </button>
        </div>

        <div id="customerTable" class="overflow-x-auto">
          <table class="w-full table-auto border-collapse border border-gray-300">
            <thead>
              <tr class="bg-gray-50">
                <th class="border border-gray-300 px-4 py-2 text-left">User ID</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Name</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Email</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Date of Birth</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Marketing Consent</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Registration Date</th>
                <th class="border border-gray-300 px-4 py-2 text-left">Coffee Count</th>
              </tr>
            </thead>
            <tbody id="customerData">
              <tr>
                <td colspan="7" class="border border-gray-300 px-4 py-8 text-center text-gray-500">
                  No customer data available. This dashboard collects data from customer registrations.
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="mt-8 p-4 bg-blue-50 rounded-lg">
          <h3 class="font-semibold text-blue-800 mb-2">How to Collect Customer Data:</h3>
          <ol class="text-sm text-blue-700 space-y-1">
            <li>1. When customers register via the loyalty page, their data is automatically added here</li>
            <li>2. Use the "Export to CSV" button to download customer data for your records</li>
            <li>3. Data includes name, email, DOB, and marketing preferences for targeted promotions</li>
            <li>4. Check this dashboard regularly to see new registrations</li>
          </ol>
        </div>
      </div>
    </div>
  </main>

  <script src="../script.js"></script>
  <script>
    // Staff dashboard functionality
    const STAFF_PASSWORD = 'mustard2024'; // Change this to your desired password

    let customers = [];

    function checkStaffAccess() {
      const hasAccess = localStorage.getItem('staffAccess') === 'true';
      if (hasAccess) {
        showDashboard();
      } else {
        showPasswordForm();
      }
    }

    function showPasswordForm() {
      document.getElementById('passwordForm').classList.remove('hidden');
      document.getElementById('dashboard').classList.add('hidden');
    }

    function showDashboard() {
      document.getElementById('passwordForm').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      loadCustomerData();
    }

    function loadCustomerData() {
      customers = JSON.parse(localStorage.getItem('registeredCustomers')) || [];
      displayCustomers();
    }

    function displayCustomers() {
      const tbody = document.getElementById('customerData');

      if (customers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="border border-gray-300 px-4 py-8 text-center text-gray-500">
              No customer data available yet. Customer registrations will appear here automatically.
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = customers.map(customer => `
        <tr>
          <td class="border border-gray-300 px-4 py-2 font-mono text-sm">${customer.userId}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.name}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.email}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.dob || 'Not provided'}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.marketingConsent ? 'Yes' : 'No'}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.registrationDate}</td>
          <td class="border border-gray-300 px-4 py-2">${customer.coffeeCount || 0}</td>
        </tr>
      `).join('');
    }

    function exportToCSV() {
      if (customers.length === 0) {
        alert('No customer data to export');
        return;
      }

      const headers = ['User ID', 'Name', 'Email', 'Date of Birth', 'Marketing Consent', 'Registration Date', 'Coffee Count'];
      const csvContent = [
        headers.join(','),
        ...customers.map(customer => [
          customer.userId,
          `"${customer.name}"`,
          customer.email,
          customer.dob || '',
          customer.marketingConsent ? 'Yes' : 'No',
          customer.registrationDate,
          customer.coffeeCount || 0
        ].join(','))
      ].join('\n');

      const blob = new Blob([csvContent], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `loyalty-customers-${new Date().toISOString().split('T')[0]}.csv`;
      a.click();
      window.URL.revokeObjectURL(url);
    }

    // Event listeners
    document.getElementById('staffLoginForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const password = document.getElementById('staffPassword').value;

      if (password === STAFF_PASSWORD) {
        localStorage.setItem('staffAccess', 'true');
        showDashboard();
      } else {
        alert('Incorrect password');
        document.getElementById('staffPassword').value = '';
      }
    });

    document.getElementById('exportBtn').addEventListener('click', exportToCSV);
    document.getElementById('refreshBtn').addEventListener('click', loadCustomerData);

    // Initialize
    checkStaffAccess();
  </script>
</body>
</html></content>
<parameter name="filePath">/Users/bhattey/cafe-loyalty/mustard seed cafe/staff.html